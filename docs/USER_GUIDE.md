# Google検索リサーチツール - ユーザーガイド

**バージョン**: 1.0.0
**最終更新**: 2025年12月1日

---

## 目次

1. [はじめに](#はじめに)
2. [インストール](#インストール)
3. [初期設定](#初期設定)
4. [基本的な使い方](#基本的な使い方)
5. [高度な使い方](#高度な使い方)
6. [トラブルシューティング](#トラブルシューティング)
7. [FAQ](#faq)

---

## はじめに

Google検索リサーチツールは、クラウドワークスなどのリサーチ案件における情報収集作業を自動化・効率化するためのデスクトップアプリケーションです。

### 主な機能

- **Tavily API統合検索**: 月1,000件まで無料で検索可能
- **高精度な詳細情報抽出**: 電話番号、メール、住所、営業時間など
- **Excel形式での自動出力**: 整形済みデータを即座にExcelファイルで取得
- **GUI/CLI両対応**: モダンなGUIとシンプルなCLIの両方で利用可能

### システム要件

- **OS**: Windows 10/11, macOS 10.15+, Linux（Ubuntu 20.04+推奨）
- **Python**: 3.10以上
- **メモリ**: 2GB以上推奨
- **ストレージ**: 100MB以上の空き容量
- **インターネット接続**: 必須

---

## インストール

### 1. Pythonのインストール

Python 3.10以上がインストールされていることを確認してください。

```bash
python3 --version
```

### 2. リポジトリのクローン

```bash
git clone <repository-url>
cd google_research
```

### 3. 仮想環境の作成

```bash
# 仮想環境の作成
python3 -m venv venv

# 仮想環境の有効化（macOS/Linux）
source venv/bin/activate

# 仮想環境の有効化（Windows）
venv\Scripts\activate
```

### 4. 依存パッケージのインストール

```bash
pip install -r requirements.txt
```

---

## 初期設定

### Tavily APIキーの取得

1. https://app.tavily.com/ にアクセス
2. 「Sign Up」をクリックして無料アカウントを作成
3. ダッシュボードからAPIキーをコピー

### .envファイルの設定

1. `.env.example`をコピーして`.env`ファイルを作成

```bash
cp .env.example .env
```

2. `.env`ファイルを編集してAPIキーを設定

```
SEARCH_API_PROVIDER=tavily
TAVILY_API_KEY=tvly-your-api-key-here
```

### 動作確認

```bash
python3 test_tavily_api.py
```

正常に動作すれば、検索結果が表示されます。

---

## 基本的な使い方

### GUI版（推奨）

#### 1. アプリケーションの起動

```bash
source venv/bin/activate
python3 main_gui.py
```

#### 2. 検索の実行

1. **検索キーワードを入力**
   - 左側のパネルの「検索キーワード」フィールドに入力
   - 例: 「東京 歯科医院」

2. **取得件数を指定**
   - デフォルト: 10件
   - 範囲: 1〜100件

3. **詳細情報の取得を選択（オプション）**
   - チェックボックスをONにすると、電話番号・メール・住所などを抽出
   - ⚠️ 注意: 詳細情報取得には時間がかかります

4. **検索開始をクリック**
   - 検索が開始され、右側のパネルに結果が表示される
   - 進捗状況がリアルタイムで表示される

5. **Excelに出力をクリック**
   - 検索結果をExcelファイルとして保存
   - ファイル名: `search_results_YYYYMMDD_HHMMSS.xlsx`
   - 保存先: `output/`ディレクトリ

### CLI版

#### 1. アプリケーションの起動

```bash
source venv/bin/activate
python3 main.py
```

#### 2. 対話形式で入力

```
検索キーワードを入力してください: 東京 歯科医院
検索結果の取得件数を入力してください (デフォルト: 10): 10
詳細情報を取得しますか? (y/n, デフォルト: n): y
```

#### 3. 自動でExcel出力

処理が完了すると、自動的にExcelファイルが生成されます。

---

## 高度な使い方

### 検索のコツ

#### 効果的なキーワードの選び方

**良い例:**
- 「東京 渋谷 歯科医院」（地域を絞る）
- 「大阪 美容室 カット」（業種と特徴を指定）
- 「名古屋 税理士 法人」（業態を指定）

**悪い例:**
- 「歯科」（範囲が広すぎる）
- 「東京都渋谷区神宮前1-2-3」（住所では検索しない）

#### 取得件数の目安

| 件数 | 用途 | 所要時間（詳細情報あり） |
|------|------|----------------------|
| 10件 | テスト・確認 | 約30秒 |
| 30件 | 小規模リサーチ | 約1.5分 |
| 50件 | 中規模リサーチ | 約2.5分 |
| 100件 | 大規模リサーチ | 約5分 |

### 詳細情報の抽出精度

#### 抽出可能な情報

| 情報 | 抽出精度 | 備考 |
|------|---------|------|
| 電話番号 | 高（90%+） | 13種類のパターン対応 |
| メールアドレス | 高（85%+） | info@, contact@など |
| 会社名・店舗名 | 高（80%+） | JSON-LD優先 |
| 郵便番号 | 高（90%+） | 〒マーク対応 |
| 都道府県 | 高（85%+） | 47都道府県対応 |
| 営業時間 | 中（50%+） | サイト構造に依存 |
| 定休日 | 中（50%+） | サイト構造に依存 |
| SNSリンク | 高（80%+） | Twitter/Facebook/Instagram |

### Excel出力の活用

#### 出力ファイルの構造

Excelファイルには以下のシートが含まれます:

- **検索結果シート**: 全データ（15列）
  - 順位、タイトル、URL、説明
  - 電話番号、メール、FAX
  - 郵便番号、都道府県
  - 会社名・店舗名
  - 営業時間、定休日
  - Twitter、Facebook、Instagram

#### データの並べ替え

1. Excelでファイルを開く
2. 任意の列をクリック
3. 「データ」→「並べ替え」

#### フィルタリング

1. ヘッダー行を選択
2. 「データ」→「フィルター」
3. 列ヘッダーのドロップダウンから条件を指定

---

## トラブルシューティング

### よくある問題と解決方法

#### 1. "ModuleNotFoundError: No module named 'customtkinter'"

**原因**: 依存パッケージがインストールされていない

**解決方法**:
```bash
source venv/bin/activate
pip install -r requirements.txt
```

#### 2. "Tavily API key not found"

**原因**: .envファイルにAPIキーが設定されていない

**解決方法**:
1. .envファイルを確認
2. `TAVILY_API_KEY=tvly-your-api-key-here`が設定されているか確認
3. APIキーが正しいか確認

#### 3. 検索結果が取得できない

**原因**: ネットワーク接続の問題、または月間クエリ数超過

**解決方法**:
1. インターネット接続を確認
2. Tavilyダッシュボードで月間クエリ数を確認
3. ログファイル（logs/app.log）を確認

#### 4. 詳細情報が抽出できない

**原因**: Webサイトの構造が特殊、またはrobots.txtでクロール禁止

**解決方法**:
- 正常な動作です。すべてのサイトから抽出できるわけではありません
- 抽出精度は50-90%程度です

#### 5. Excelファイルが開けない

**原因**: ファイルが破損している、または権限がない

**解決方法**:
1. ファイルの存在を確認
2. ファイルの権限を確認
3. 再度検索を実行してファイルを生成

---

## FAQ

### Q1: Tavily APIの無料枠はどれくらい？

**A**: 月間1,000クエリまで無料です。クレジットカード登録は不要です。

### Q2: 月間1,000件を超えたらどうなる？

**A**: 有料プラン（$30/月で4,000クエリ）への移行が必要です。または、Google Custom Search APIに切り替えることもできます。

### Q3: Google Custom Search APIに切り替えられる？

**A**: はい、.envファイルで簡単に切り替え可能です。

```
SEARCH_API_PROVIDER=google
GOOGLE_API_KEY=your-google-api-key
GOOGLE_CSE_ID=your-cse-id
```

### Q4: どのくらいの頻度で検索できる？

**A**: Tavily APIには特定のレート制限はありませんが、常識的な範囲でご利用ください。

### Q5: 商用利用は可能？

**A**: はい、Tavily APIの利用規約に従う限り、商用利用可能です。

### Q6: データの精度はどれくらい？

**A**: 検索精度は約95%、詳細情報抽出は50-90%です。サイトの構造によって変動します。

### Q7: ログファイルはどこにある？

**A**: `logs/app.log`に保存されます。

### Q8: 出力ファイルの保存先を変更できる？

**A**: `config/settings.py`の`OUTPUT_DIR`を変更することで可能です。

### Q9: CLIとGUIはどちらを使うべき？

**A**:
- **GUI版推奨**: 初心者、視覚的な操作を好む方
- **CLI版推奨**: スクリプト化、自動化したい方

### Q10: エラーが発生した場合は？

**A**:
1. ログファイル（logs/app.log）を確認
2. GitHubのIssuesで報告
3. または本ドキュメントのトラブルシューティングを参照

---

## サポート

### 問い合わせ先

- **GitHub Issues**: https://github.com/your-repo/issues
- **ドキュメント**: docs/

### 関連ドキュメント

- [README.md](../README.md) - プロジェクト概要
- [TAVILY_SETUP.md](TAVILY_SETUP.md) - Tavily API設定
- [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md) - 開発者向けガイド

---

**Happy Researching! 🎉**
