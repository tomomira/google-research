# 検索API比較ドキュメント

作成日: 2025年11月28日

## 概要

Google検索リサーチツールで使用する検索APIの比較検討結果をまとめたドキュメント。
スクレイピングの課題（JavaScriptの必要性、CAPTCHA、安定性）を解決するため、検索APIの導入を検討。

---

## 比較対象API

1. **Google Custom Search JSON API**
2. **Tavily API**
3. **Brave Search API**（参考）

---

## 詳細比較

### 1. Google Custom Search JSON API

#### 料金体系（2025年）
- **無料枠**: 1日100クエリまで（月間約3,000クエリ）
- **有料プラン**: $5/1,000クエリ
- **上限**: 1日10,000クエリまで
- **クレジットカード**: 有料利用時に必要

#### メリット
- ✅ Googleの公式API、最高の検索精度
- ✅ 日本語対応が完璧
- ✅ 安定性が高い
- ✅ コストパフォーマンスが良い（$5/1,000件）
- ✅ 構造化されたJSON形式で結果を取得

#### デメリット
- ❌ 初期設定が必要（APIキー、Custom Search Engine作成）
- ❌ 1日10,000クエリの上限あり
- ❌ Custom Search Engineの設定が複雑

#### 検索精度
- **一般検索**: ⭐⭐⭐⭐⭐ (100点)
- **数値データ**: ⭐⭐⭐⭐⭐ (日経平均株価: 38,407.71円 vs 実際38,403.32円、誤差0.01%)
- **店舗情報**: ⭐⭐⭐⭐⭐
- **日本語対応**: ⭐⭐⭐⭐⭐

#### コスト例
| 検索件数/月 | 月間コスト |
|------------|-----------|
| 3,000件まで | $0（無料） |
| 5,000件 | $10（約1,500円） |
| 10,000件 | $35（約5,250円） |
| 50,000件 | $235（約35,250円） |

---

### 2. Tavily API ⭐ 採用

#### 料金体系（2025年）
- **無料枠**: 1,000クレジット/月（クレカ登録不要）
- **従量課金**: $8/1,000クレジット（$0.008/クレジット）
- **月額プラン**:
  - Project: $30/月（4,000クレジット）
  - Growth: $500/月（100,000クレジット）
- **クレジットカード**: 無料プランでは不要

**クレジット消費:**
- 基本検索（basic）: 1クエリ = 1クレジット
- 高度検索（advanced）: 1クエリ = 2クレジット

#### メリット
- ✅ クレカ不要で無料枠を利用可能
- ✅ AI・LLM統合に最適化
- ✅ 実装がシンプル
- ✅ 1回のAPI呼び出しで最大20サイトを集約
- ✅ AI要約機能が組み込み
- ✅ 最新情報の取得が高速
- ✅ 店舗情報検索には十分な精度

#### デメリット
- ❌ Googleより料金が高い（$8 vs $5/1,000件）
- ❌ 数値データの精度がGoogleよりやや低い
- ❌ 無料枠が少ない（1,000件 vs Googleの3,000件相当）

#### 検索精度
- **一般検索**: ⭐⭐⭐⭐ (95点)
- **数値データ**: ⭐⭐⭐ (日経平均株価: 37,965.10円 vs 実際38,403.32円、誤差1.14%)
- **店舗情報**: ⭐⭐⭐⭐（実用上問題なし）
- **日本語対応**: ⭐⭐⭐⭐

#### コスト例
| 検索件数/月 | 月間コスト |
|------------|-----------|
| 1,000件まで | $0（無料） |
| 5,000件 | $32（約4,800円） |
| 10,000件 | $72（約10,800円） |
| 50,000件 | $392（約58,800円） |

---

### 3. Brave Search API（参考）

#### 料金体系
- **無料枠**: 2,000クエリ/月
- **有料プラン**: $3/1,000クエリ（最も安い）

#### メリット
- ✅ 最も安価（$3/1,000件）
- ✅ プライバシー重視

#### デメリット
- ❌ 日本語検索の精度が不明
- ❌ Googleほど普及していない

---

## 比較表（総合）

| 項目 | Google Custom Search | Tavily | Brave Search |
|------|---------------------|--------|--------------|
| **無料枠（月）** | 約3,000件 | 1,000件 | 2,000件 |
| **料金** | $5/1,000件 | $8/1,000件 | $3/1,000件 |
| **検索精度（一般）** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ |
| **日本語対応** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ |
| **実装難易度** | 中 | 易 | 易 |
| **クレカ登録** | 必要（有料時） | 不要 | 必要（有料時） |
| **AI統合** | - | ⭐⭐⭐⭐⭐ | - |

---

## 採用決定

### 選択: Tavily API

#### 理由
1. **クレカ不要で試せる** - 開発・テスト段階でリスクなし
2. **検索精度は十分** - 店舗情報検索には問題なし（95点）
3. **実装が簡単** - シンプルなJSON API
4. **AI要約機能** - 検索結果の要約が自動化
5. **段階的移行可能** - 将来的にGoogleへの切り替えも容易

#### 段階的なプラン

**Phase 1-2: Tavily（開発・テスト・小規模運用）**
- 無料枠: 月1,000件まで無料
- 用途: 開発、テスト、小規模な案件（1案件100件以下）
- メリット: コストゼロで開発可能

**Phase 3以降: 状況に応じて選択**
- 月1,000件以下: Tavily無料枠で継続
- 月1,000-3,000件: Googleに切り替え（無料枠活用）
- 月3,000件以上: コスト比較してGoogleに移行検討

---

## 実装方針

### アーキテクチャ設計

両方のAPIをサポートする柔軟な設計にする：

```python
# config/settings.py に追加
SEARCH_API_PROVIDER = "tavily"  # "tavily" or "google"
TAVILY_API_KEY = os.getenv("TAVILY_API_KEY", "")
GOOGLE_API_KEY = os.getenv("GOOGLE_API_KEY", "")
GOOGLE_CX_ID = os.getenv("GOOGLE_CX_ID", "")
```

### 実装ステップ

1. **Tavily API統合** - Phase 1で実装
   - APIキー取得（5分）
   - `core/searcher.py`にTavily検索機能を追加
   - テスト実行

2. **Google API準備** - Phase 2以降
   - APIキー取得
   - Custom Search Engine作成
   - `core/searcher.py`にGoogle検索機能を追加

3. **切り替え機能** - Phase 3
   - 設定ファイルで簡単に切り替え可能に
   - コスト監視機能の追加

---

## コスト試算

### ユースケース: クラウドワークスのリサーチ案件

**前提条件:**
- 1案件あたり平均100件検索
- 月10案件実施

**シナリオA: Tavily（無料枠内）**
- 検索件数: 1,000件/月
- コスト: **$0/月（無料）**

**シナリオB: Tavily（有料）**
- 検索件数: 5,000件/月
- コスト: **$32/月（約4,800円）**

**シナリオC: Google（有料）**
- 検索件数: 5,000件/月
- コスト: **$10/月（約1,500円）**

**損益分岐点:**
- 月3,000件まで: Google無料枠が有利
- 月3,000-10,000件: Googleが有利（コスト60%削減）

---

## 参考リンク

### Google Custom Search API
- [Custom Search JSON API - Google Developers](https://developers.google.com/custom-search/v1/overview)
- [プログラム可能な検索エンジン](https://programmablesearchengine.google.com/)

### Tavily API
- [Tavily API Documentation](https://docs.tavily.com/)
- [Tavily Credits & Pricing](https://docs.tavily.com/documentation/api-credits)
- [Tavily Dashboard](https://app.tavily.com/)

### 比較記事
- [Google,Tavily ,Braveの検索API比較 - Qiita](https://qiita.com/nnoti0810/items/8252771202ab9cbf2614)
- [うさぎでもわかるLLM検索APIサービス比較 2025年最新版 - Zenn](https://zenn.dev/taku_sid/articles/20250418_search_api_comparison)
- [TavilyとCustom Search APIを徹底比較 - WEEL](https://weel.co.jp/media/tavily/)
- [検索APIの比較まとめ - WEEL](https://weel.co.jp/media/search-api-summary/)

---

## まとめ

**採用API: Tavily API**

**決定理由:**
1. 無料で試せる（クレカ不要）
2. 実装が簡単
3. 検索精度は実用上十分
4. 将来的にGoogleへの移行も容易

**注意点:**
- 大規模運用（月3,000件以上）ではGoogleの方がコスト効率が良い
- 定期的にコストを見直し、必要に応じてGoogle APIへ移行する

**次のアクション:**
1. Tavily APIキーの取得
2. `core/searcher.py`へのTavily統合実装
3. 実際の検索テストの実行

---

**作成者**: 開発チーム
**ステータス**: Tavily採用決定
**最終更新**: 2025年11月28日
